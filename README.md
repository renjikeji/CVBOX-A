# Cvbox 技术文档

## 一、正文

### 调用硬件盒子的三大要素

1. **初始化连接硬件**：可以通过网页 API 或者 Windows 本地程序。
2. **读取硬件状态**：通过硬件上传的数据可以判断当前鼠标的按键状态。
3. **写入鼠标移动**：通过封装的函数，直接传入需要移动的 x、y 的量。
4. **写入鼠标点击、放开**：通过封装的函数，传入需要模拟的按键，本产品支持按下指定时间后松开。

---

### 初始化连接硬件

- **网页 API 连接**：可以直接访问 [https://cvbox.net/](https://cvbox.net/)，点击网页驱动，即可连接到硬件。
- **Windows 程序连接**：提供了 C++ 的代码示例，用户可自由根据示例调用移动和点击。

#### C++ 示例代码：
```cpp
bool status = init_cbox();
printf("status %s \t\n", status ? "初始化成功" : "初始化失败");
```

---

### 读取鼠标状态

- 在 Windows 程序中，通过 C++ 提供的代码示例，初始化硬件后，调用以下代码，则可通过 `Enable_Monitor` 函数打开键鼠状态监视。

#### C++ 示例代码：
```cpp
// 打开键鼠状态监视
Enable_Monitor(true);
```

- 打开状态监视之后，则可通过 `MonitorKeyStatus` 来检测鼠标的按键状态，转而不再通过 Windows 提供的函数检测。

#### C++ 示例代码：
```cpp
bool LeftStatus = MonitorKeyStatus(0x01); // 左键是否按下
bool RightStatus = MonitorKeyStatus(0x02); // 监测右键是否按下
bool MiddleStatus = MonitorKeyStatus(0x04); // 监测中键是否按下
bool ForwardSideStatus = MonitorKeyStatus(0x08); // 监测硬件设备中前侧键标识
bool RearSideStatus = MonitorKeyStatus(0x10); // 监测硬件设备中后侧键标识
```

---

### 向硬件通讯移动和点击

1. **移动**：向硬件通讯移动操作，直接向其写入指定格式的数据即可实现移动。
   - **Windows 平台**：C++ 程序提供了函数，以下是一个简单的示例：
     ```cpp
     cvbox_mouse_move(1, 0); // x 方向移动一个像素点
     ```
   - **网页驱动**：调用相同的代码也可实现移动。

2. **点击**：向硬件通讯移动操作，直接向其写入指定格式的数据即可实现按键的点击与松开。
   - **Windows 平台**：C++ 程序提供了函数，以下是一个简单的示例：
     ```cpp
     cvbox_mouse_down(1); // 左键点击
     Sleep(400); // 等待 400 毫秒
     cvbox_mouse_down(0); // 400 毫秒后松开
     ```
   - **网页驱动**：调用相同的代码也可实现点击与松开。

---

## 四、总结

本文档阐述了调用硬件盒子的三大关键要素，即**初始化连接硬件**、**读取硬件状态**以及**写入鼠标移动和点击操作**。

- **初始化连接硬件**：可通过网页 API 访问 [https://cvbox.net/](https://cvbox.net/) 点击网页驱动，或在 Windows 程序中参考 C++ 代码示例完成。
- **读取鼠标状态**：可借助 Windows 程序中的 C++ 代码示例，通过特定函数实现对鼠标各按键状态的有效监测。
- **向硬件通讯移动和点击操作**：无论是在 Windows 平台的 C++ 程序还是网页驱动中，都能通过写入指定格式数据及调用相应函数达成。

通过这些步骤和方法，用户能够顺利实现对硬件盒子的调用，满足各类操作需求，为相关硬件设备的使用提供了清晰且可行的技术指引。
